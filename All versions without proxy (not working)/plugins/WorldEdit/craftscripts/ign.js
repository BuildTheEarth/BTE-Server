!function(){"use strict";function t(e,r,n){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(r):s.value}})(e,r,n||e)}function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");var r,n;t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&(r=t,n=e,(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(r,n))}function n(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,s,a,o=i(t);if(r){var h=i(this).constructor;n=Reflect.construct(o,arguments,h)}else n=o.apply(this,arguments);return s=this,!(a=n)||"object"!==e(a)&&"function"!=typeof a?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(s):a}}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}importPackage(Packages.java.io),importPackage(Packages.java.awt);var h=function(){function t(){s(this,t),this.Orientation={none:1,upright:2,swapped:3}}return o(t,[{key:"orientProjection",value:function(t){return t.upright()?t:new l(t)}},{key:"upright",value:function(){return this.fromGeo(0,90)[1]<=this.fromGeo(0,-90)[1]}}]),t}(),c=function(t){r(i,h);var e=n(i);function i(t){var r;return s(this,i),(r=e.call(this)).input=t,r}return o(i,[{key:"upright",value:function(){return this.input.upright()}},{key:"bounds",value:function(){return this.input.bounds()}},{key:"metersPerUnit",value:function(){return this.input.metersPerUnit()}}]),i}(),l=function(t){r(i,c);var e=n(i);function i(){return s(this,i),e.apply(this,arguments)}return o(i,[{key:"toGeo",value:function(t,e){return this.input.toGeo(t,-e)}},{key:"fromGeo",value:function(t,e){var r=this.input.fromGeo(t,e);return r[1]=-r[1],r}},{key:"upright",value:function(){return!this.input.upright()}},{key:"bounds",value:function(){var t=this.input.bounds();return new[t[0],-t[3],t[2],-t[1]]}}]),i}(),u=function(t){r(i,c);var e=n(i);function i(t,r,n){var a;return s(this,i),(a=e.call(this,t)).scaleX=r,a.scaleY=n||r,a}return o(i,[{key:"toGeo",value:function(t,e){return this.input.toGeo(t/this.scaleX,e/this.scaleY)}},{key:"fromGeo",value:function(t,e){var r=this.input.fromGeo(t,e);return r[0]*=this.scaleX,r[1]*=this.scaleY,r}},{key:"upright",value:function(){return!!(this.scaleY<0^this.input.upright())}},{key:"bounds",value:function(){var t=this.input.bounds();return t[0]*=this.scaleX,t[1]*=this.scaleY,t[2]*=this.scaleX,t[3]*=this.scaleY,t}},{key:"metersPerUnit",value:function(){return this.input.metersPerUnit()/Math.sqrt((this.scaleX*this.scaleX+this.scaleY*this.scaleY)/2)}}]),i}(),T=function(t){r(i,h);var e=n(i);function i(){var t;s(this,i),(t=e.call(this)).ARC=2*Math.asin(Math.sqrt(5-Math.sqrt(5))/Math.sqrt(10)),t.TO_RADIANS=Math.PI/180,t.ROOT3=Math.sqrt(3),t.newton=5,t.VERT=[10.536199,64.7,-5.24539,2.300882,58.157706,10.447378,122.3,39.1,-143.47849,50.103201,-67.13233,23.717925,36.52151,-50.1032,112.867673,-23.71793,174.75461,-2.300882,-121.84229,-10.44735,-57.7,-39.1,-169.4638,-64.7],t.ISO=[2,1,6,1,0,2,0,1,5,1,5,10,1,6,10,7,2,6,2,3,7,3,0,2,0,3,4,4,0,5,5,4,9,9,5,10,10,9,11,11,6,10,6,7,11,8,3,7,8,3,4,8,4,9,9,8,11,7,8,11,11,6,7,3,7,8],t.CENTER_MAP=[-3,7,-2,5,-1,7,2,5,4,5,-4,1,-3,-1,-2,1,-1,-1,0,1,1,-1,2,1,3,-1,4,1,5,-1,-3,-5,-1,-5,1,-5,2,-7,-4,-7,-5,-5,-2,-7],t.FLIP_TRIANGLE=[1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,1,1,0,0,1,0],t.CENTROID=new Array(66),t.ROTATION_MATRIX=new Array(198),t.INVERSE_ROTATION_MATRIX=new Array(198);for(var r=0;r<22;r++)t.CENTER_MAP[2*r]*=.5*t.ARC,t.CENTER_MAP[2*r+1]*=t.ARC*t.ROOT3/12;for(var n=0;n<12;n++)t.VERT[2*n+1]=90-t.VERT[2*n+1],t.VERT[2*n]*=t.TO_RADIANS,t.VERT[2*n+1]*=t.TO_RADIANS;for(var a=0;a<22;a++){var o=t.cart(t.VERT[2*t.ISO[3*a]],t.VERT[2*t.ISO[3*a]+1]),h=t.cart(t.VERT[2*t.ISO[3*a+1]],t.VERT[2*t.ISO[3*a+1]+1]),c=t.cart(t.VERT[2*t.ISO[3*a+2]],t.VERT[2*t.ISO[3*a+2]+1]),l=o[0]+h[0]+c[0],u=o[1]+h[1]+c[1],T=o[2]+h[2]+c[2],R=Math.sqrt(l*l+u*u+T*T);t.CENTROID[3*a]=l/R,t.CENTROID[3*a+1]=u/R,t.CENTROID[3*a+2]=T/R;var f=Math.atan2(u,l),O=Math.atan2(Math.sqrt(l*l+u*u),T),v=[t.VERT[2*t.ISO[3*a]],t.VERT[2*t.ISO[3*a]+1]];v=t.yRot(v[0]-f,v[1],-O),t.produceZYZRotationMatrix(t.ROTATION_MATRIX,9*a,-f,-O,Math.PI/2-v[0]),t.produceZYZRotationMatrix(t.INVERSE_ROTATION_MATRIX,9*a,v[0]-Math.PI/2,O,f)}return t.FACE_ON_GRID=[-1,-1,0,1,2,-1,-1,3,-1,4,-1,-1,5,6,7,8,9,10,11,12,13,14,20,19,15,21,16,-1,17,18,-1,-1,-1],t.Z=Math.sqrt(5+2*Math.sqrt(5))/Math.sqrt(15),t.EL=Math.sqrt(8)/Math.sqrt(5+Math.sqrt(5)),t.EL6=t.EL/6,t.DVE=Math.sqrt(3+Math.sqrt(5))/Math.sqrt(5+Math.sqrt(5)),t.R=-3*t.EL6/t.DVE,t.OUT_OF_BOUNDS=[NaN,NaN],t}return o(i,[{key:"produceZYZRotationMatrix",value:function(t,e,r,n,i){var s=Math.sin(r),a=Math.cos(r),o=Math.sin(n),h=Math.cos(n),c=Math.sin(i),l=Math.cos(i);t[e+0]=a*h*l-c*s,t[e+1]=-s*h*l-c*a,t[e+2]=l*o,t[e+3]=c*h*a+l*s,t[e+4]=l*a-c*h*s,t[e+5]=c*o,t[e+6]=-o*a,t[e+7]=o*s,t[e+8]=h}},{key:"cart",value:function(t,e){var r=Math.sin(e);return[r*Math.cos(t),r*Math.sin(t),Math.cos(e)]}},{key:"findTriangle",value:function(t,e,r){for(var n=Number.MAX_VALUE,i=0,s=0;s<20;s++){var a=this.CENTROID[3*s]-t,o=this.CENTROID[3*s+1]-e,h=this.CENTROID[3*s+2]-r,c=a*a+o*o+h*h;if(c<n){if(c<.1)return s;i=s,n=c}}return i}},{key:"findMapTriangle",value:function(t,e){for(var r=Number.MAX_VALUE,n=0,i=0;i<20;i++){var s=this.CENTER_MAP[2*i]-t,a=this.CENTER_MAP[2*i+1]-e,o=s*s+a*a;o<r&&(n=i,r=o)}return n}},{key:"findTriangleGrid",value:function(t,e){var r,n=t/this.ARC,i=e/(this.ARC*this.ROOT3);if(i>-.25)if(i<.25)r=1;else{if(!(i<=.75))return-1;r=0,i=.5-i}else{if(!(i>=-.75))return-1;r=2,i=-i-.5}var s=n-(i+=.25),a=n+i,o=Math.floor(s),h=2*o+(Math.floor(a)!==o?1:0)+6;return h<0||h>=11?-1:this.FACE_ON_GRID[11*r+h]}},{key:"triangleTransform",value:function(t,e,r){var n=this.Z/r,i=n*t,s=n*e,a=Math.atan((2*s/this.ROOT3-this.EL6)/this.DVE),o=Math.atan((i-s/this.ROOT3-this.EL6)/this.DVE),h=Math.atan((-i-s/this.ROOT3-this.EL6)/this.DVE);return[.5*(o-h),(2*a-o-h)/(2*this.ROOT3)]}},{key:"inverseTriangleTransformNewton",value:function(t,e){for(var r=Math.tan(this.ROOT3*e+t),n=Math.tan(2*t),i=r*r+1,s=n*n+1,a=r,o=n,h=0,c=1,l=1,u=0;u<this.newton;u++)a=((h-=(a+o+h-this.R)/(i*c*c+s*l*l+1))+r)*(c=1/(1-h*r)),o=(h+n)*(l=1/(1-h*n));var T=this.ROOT3*(this.DVE*a+this.EL6)/2,R=(this.DVE*o+T/this.ROOT3+this.EL6)/this.Z,f=T/this.Z,O=1/Math.sqrt(1+R*R+f*f);return[O*R,O*f,O]}},{key:"inverseTriangleTransformCbrt",value:function(t,e){var r=Math.tan(this.ROOT3*e+t),n=Math.tan(2*t),i=n*r,s=-(this.R*n*r+2*n+2*r),a=3+this.R*n+this.R*r-2*n*r,o=-s/(3*i),h=o*o*o+(s*a-3*i*(n+r-this.R))/(6*i*i),c=a/(3*i)-o*o,l=Math.sqrt(-(h*h+c*c*c)),u=Math.sqrt(l*l+h*h),T=Math.atan2(l,h),R=2*Math.cbrt(u)*Math.cos(T/3)+o,f=(R+r)/(1-R*r),O=(R+n)/(1-R*n),v=this.ROOT3*(this.DVE*f+this.EL6)/2,A=(this.DVE*O+v/this.ROOT3+this.EL6)/this.Z,g=v/this.Z,E=1/Math.sqrt(1+A*A+g*g);return[E*A,E*g,E]}},{key:"inverseTriangleTransformCbrtNewton",value:function(t,e){for(var r=Math.tan(this.ROOT3*e+t),n=Math.tan(2*t),i=r+n,s=n*r,a=-(this.R*s+2*n+2*r),o=3+this.R*i-2*s,h=i-this.R,c=3*s,l=2*a,u=-h/o,T=0;T<this.newton;T++){var R=u*u;u-=(s*R*u+a*R+o*u+h)/(c*R+l*u+o)}var f=(u+r)/(1-u*r),O=(u+n)/(1-u*n),v=this.ROOT3*(this.DVE*f+this.EL6)/2,A=(this.DVE*O+v/this.ROOT3+this.EL6)/this.Z,g=v/this.Z,E=1/Math.sqrt(1+A*A+g*g);return[E*A,E*g,E]}},{key:"inverseTriangleTransform",value:function(t,e){return this.inverseTriangleTransformNewton(t,e)}},{key:"yRot",value:function(t,e,r){var n=this.cart(t,e),i=n[0];n[0]=n[2]*Math.sin(r)+i*Math.cos(r),n[2]=n[2]*Math.cos(r)-i*Math.sin(r);var s=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return n[0]/=s,n[1]/=s,n[2]/=s,[Math.atan2(n[1],n[0]),Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),n[2])]}},{key:"fromGeo",value:function(t,e){e=90-e,t*=this.TO_RADIANS,e*=this.TO_RADIANS;var r=Math.sin(e),n=Math.cos(t)*r,i=Math.sin(t)*r,s=Math.cos(e),a=this.findTriangle(n,i,s),o=9*a,h=n*this.ROTATION_MATRIX[o+0]+i*this.ROTATION_MATRIX[o+1]+s*this.ROTATION_MATRIX[o+2],c=n*this.ROTATION_MATRIX[o+3]+i*this.ROTATION_MATRIX[o+4]+s*this.ROTATION_MATRIX[o+5],l=n*this.ROTATION_MATRIX[o+6]+i*this.ROTATION_MATRIX[o+7]+s*this.ROTATION_MATRIX[o+8],u=this.triangleTransform(h,c,l);return 0!==this.FLIP_TRIANGLE[a]&&(u[0]=-u[0],u[1]=-u[1]),n=u[0],(15===a&&n>u[1]*this.ROOT3||14===a)&&n>0&&(u[0]=.5*n-.5*this.ROOT3*u[1],u[1]=.5*this.ROOT3*n+.5*u[1],a+=6),u[0]+=this.CENTER_MAP[2*a],u[1]+=this.CENTER_MAP[2*a+1],u}},{key:"toGeo",value:function(t,e){var r=this.findTriangleGrid(t,e);if(-1===r)return this.OUT_OF_BOUNDS;switch(t-=this.CENTER_MAP[2*r],e-=this.CENTER_MAP[2*r+1],r){case 14:if(t>0)return this.OUT_OF_BOUNDS;break;case 20:if(-e*this.ROOT3>t)return this.OUT_OF_BOUNDS;break;case 15:if(t>0&&t>e*this.ROOT3)return this.OUT_OF_BOUNDS;break;case 21:if(t<0||-e*this.ROOT3>t)return this.OUT_OF_BOUNDS}0!==this.FLIP_TRIANGLE[r]&&(t=-t,e=-e);var n=this.inverseTriangleTransform(t,e);t=n[0],e=n[1];var i=n[2],s=9*r,a=t*this.INVERSE_ROTATION_MATRIX[s+0]+e*this.INVERSE_ROTATION_MATRIX[s+1]+i*this.INVERSE_ROTATION_MATRIX[s+2],o=t*this.INVERSE_ROTATION_MATRIX[s+3]+e*this.INVERSE_ROTATION_MATRIX[s+4]+i*this.INVERSE_ROTATION_MATRIX[s+5],h=t*this.INVERSE_ROTATION_MATRIX[s+6]+e*this.INVERSE_ROTATION_MATRIX[s+7]+i*this.INVERSE_ROTATION_MATRIX[s+8];return[Math.atan2(o,a)/this.TO_RADIANS,90-Math.acos(h)/this.TO_RADIANS]}},{key:"bounds",value:function(){return[-3*this.ARC,-.75*this.ARC*this.ROOT3,2.5*this.ARC,.75*this.ARC*this.ROOT3]}},{key:"upright",value:function(){return!1}},{key:"metersPerUnit",value:function(){return Math.sqrt(5101e11/(20*this.ROOT3*this.ARC*this.ARC/4))}}]),i}(),R=function(e){r(h,T);var a=n(h);function h(){var t;s(this,h),(t=a.call(this)).VECTOR_SCALE_FACTOR=.8715371854532509;for(var e=null,r=new Array(257),n=new Array(r.length),i=0;i<r.length;i++)r[i]=[];for(var o=0;o<n.length;o++)n[o]=[];try{if((e=context.getSafeOpenFile("craftscripts/data","conformal","txt")).exists()){for(var c=new BufferedReader(new FileReader(e)),l=0;l<r.length;l++){var u=new Array(r.length-l),T=new Array(r.length-l);r[l]=u,n[l]=T}for(var R=0;R<r.length;R++)for(var f=0;f<r.length-R;f++){var v=c.readLine(),A=(v=v.substring(1,v.length()-3)).split(", ");r[f][R]=Number.parseFloat(A[0])*t.VECTOR_SCALE_FACTOR,n[f][R]=Number.parseFloat(A[1])*t.VECTOR_SCALE_FACTOR}}else player.printError("Conformal.txt doesn't exist.");c.close()}catch(g){player.printError("Can't load conformal: "+g)}return t.inverse=new O(r,n),t}return o(h,[{key:"triangleTransform",value:function(e,r,n){var s=t(i(h.prototype),"triangleTransform",this).call(this,e,r,n);return e=s[0],r=s[1],s[0]/=this.ARC,s[1]/=this.ARC,s[0]+=.5,s[1]+=this.ROOT3/6,(s=this.inverse.applyNewtonsMethod(e,r,s[0],s[1],5))[0]-=.5,s[1]-=this.ROOT3/6,s[0]*=this.ARC,s[1]*=this.ARC,s}},{key:"inverseTriangleTransform",value:function(e,r){e/=this.ARC,r/=this.ARC,e+=.5,r+=this.ROOT3/6;var n=this.inverse.getInterpolatedVector(e,r);return t(i(h.prototype),"inverseTriangleTransform",this).call(this,n[0],n[1])}},{key:"metersPerUnit",value:function(){return 40075017/(2*Math.PI)/this.VECTOR_SCALE_FACTOR}}]),h}(),f=function(e){r(h,R);var a=n(h);function h(){var t;return s(this,h),(t=a.call(this)).THETA=-150*t.TO_RADIANS,t.SIN_THETA=Math.sin(t.THETA),t.COS_THETA=Math.cos(t.THETA),t.BERING_X=-.3420420960118339,t.BERING_Y=-.322211064085279,t.ARCTIC_Y=-.2,t.ARCTIC_M=(t.ARCTIC_Y-t.ROOT3*t.ARC/4)/(t.BERING_X- -.5*t.ARC),t.ARCTIC_B=t.ARCTIC_Y-t.ARCTIC_M*t.BERING_X,t.ALEUTIAN_Y=-.5000446805492526,t.ALEUTIAN_XL=-.5149231279757507,t.ALEUTIAN_XR=-.45,t.ALEUTIAN_M=(t.BERING_Y-t.ALEUTIAN_Y)/(t.BERING_X-t.ALEUTIAN_XR),t.ALEUTIAN_B=t.BERING_Y-t.ALEUTIAN_M*t.BERING_X,t}return o(h,[{key:"fromGeo",value:function(e,r){var n=t(i(h.prototype),"fromGeo",this).call(this,e,r),s=n[0],a=n[1],o=this.isEurasianPart(s,a);if(a-=.75*this.ARC*this.ROOT3,o){var c=s+=this.ARC;s=this.COS_THETA*s-this.SIN_THETA*a,a=this.SIN_THETA*c+this.COS_THETA*a}else s-=this.ARC;return n[0]=a,n[1]=-s,n}},{key:"toGeo",value:function(e,r){var n;n=r<0?e>0:r>this.ARC/2?e>-this.ROOT3*this.ARC/2:r*-this.ROOT3<e;var s=e;return e=-r,r=s,n?(s=e,e=this.COS_THETA*e+this.SIN_THETA*r,r=this.COS_THETA*r-this.SIN_THETA*s,e-=this.ARC):e+=this.ARC,r+=.75*this.ARC*this.ROOT3,n!==this.isEurasianPart(e,r)?this.OUT_OF_BOUNDS:t(i(h.prototype),"toGeo",this).call(this,e,r)}},{key:"isEurasianPart",value:function(t,e){return!(t>0)&&(t<-.5*this.ARC||(e>this.ROOT3*this.ARC/4?t<0:e<this.ALEUTIAN_Y?e<this.ALEUTIAN_Y+this.ALEUTIAN_XL-t:e>this.BERING_Y?e<this.ARCTIC_Y?t<this.BERING_X:e<this.ARCTIC_M*t+this.ARCTIC_B:e>this.ALEUTIAN_M*t+this.ALEUTIAN_B))}},{key:"bounds",value:function(){return[-1.5*this.ARC*this.ROOT3,-1.5*this.ARC,3*this.ARC,this.ROOT3*this.ARC]}}]),h}(),O=function(){function t(e,r){s(this,t),this.ROOT3=Math.sqrt(3),this.sideLength=e.length-1,this.VECTOR_X=e,this.VECTOR_Y=r}return o(t,[{key:"getInterpolatedVector",value:function(t,e){t*=this.sideLength;var r,n,i,s,a,o,h,c,l=2*(e*=this.sideLength)/this.ROOT3,u=t-.5*l,T=Math.trunc(u),R=Math.trunc(l);T<0?T=0:T>=this.sideLength&&(T=this.sideLength-1),R<0?R=0:R>=this.sideLength-T&&(R=this.sideLength-T-1);var f=1;e<-this.ROOT3*(t-T-R-1)||R===this.sideLength-T-1?(r=this.VECTOR_X[T][R],n=this.VECTOR_Y[T][R],i=this.VECTOR_X[T][R+1],s=this.VECTOR_Y[T][R+1],a=this.VECTOR_X[T+1][R],o=this.VECTOR_Y[T+1][R],h=.5*this.ROOT3*R,c=T+1+.5*R):(r=this.VECTOR_X[T][R+1],n=this.VECTOR_Y[T][R+1],i=this.VECTOR_X[T+1][R],s=this.VECTOR_Y[T+1][R],a=this.VECTOR_X[T+1][R+1],o=this.VECTOR_Y[T+1][R+1],f=-1,e=-e,h=-.5*this.ROOT3*(R+1),c=T+1+.5*(R+1));var O=-(e-h)/this.ROOT3-(t-c),v=2*(e-h)/this.ROOT3,A=1-O-v;return[r*O+i*v+a*A,n*O+s*v+o*A,(a-r)*this.sideLength,this.sideLength*f*(2*i-r-a)/this.ROOT3,(o-n)*this.sideLength,this.sideLength*f*(2*s-n-o)/this.ROOT3]}},{key:"applyNewtonsMethod",value:function(t,e,r,n,i){for(var s=0;s<i;s++){var a=this.getInterpolatedVector(r,n),o=a[0]-t,h=a[1]-e,c=a[2],l=a[3],u=a[4],T=a[5],R=1/(c*T-l*u);r-=R*(T*o-l*h),n-=R*(-u*o+c*h)}return[r,n]}}]),t}();var v=function(){var t=function(t,e,r,n){var i=context.getSafeOpenFile(t,e,r,n);if(i.exists()){var s=new BufferedReader(new FileReader(i)),a="",o="";do{a+=o,a+="\n",o=s.readLine()}while(o);return s.close(),a}}("craftscripts","config","json",[]);return t?JSON.parse(t):{}},A=[context.getBlock("air").id,context.getBlock("tallgrass").id,context.getBlock("sapling").id,context.getBlock("log").id,context.getBlock("log2").id,context.getBlock("leaves").id,context.getBlock("leaves2").id,context.getBlock("deadbush").id,context.getBlock("red_flower").id,context.getBlock("yellow_flower").id,context.getBlock("red_mushroom").id,context.getBlock("brown_mushroom").id,context.getBlock("vine").id,context.getBlock("waterlily").id,context.getBlock("cactus").id,context.getBlock("reeds").id,context.getBlock("pumpkin").id,context.getBlock("melon_block").id,context.getBlock("snow_layer").id,context.getBlock("double_plant").id],g=(context.getBlock("grass").id,context.getBlock("dirt").id,context.getBlock("stone").id,context.getBlock("sand").id,context.getBlock("grass_path").id,context.getBlock("concrete").id,context.getBlock("gravel").id,context.getBlock("water").id,context.getBlock("lava").id,v),E={ignoredBlocks:A}.ignoredBlocks;importClass(Packages.com.sk89q.worldedit.WorldEdit),importClass(Packages.com.sk89q.worldedit.Vector),importClass(Packages.com.sk89q.worldedit.command.RegionCommands),importClass(Packages.java.io.StringWriter),importClass(Packages.java.net.URL),importClass(Packages.java.lang.Thread),importClass(Packages.java.nio.charset.StandardCharsets),importClass(Packages.org.apache.commons.io.IOUtils),context.checkArgs(0,1,"[flags]\nFlags:\n \u2022 \xa7lw\xa7r\xa7c Keeps water\n \u2022 \xa7ls\xa7r\xa7c Removes smoothing step");var p={smooth:!0};argv[1]&&(argv[1]=""+argv[1],p.water=argv[1].includes("w"),p.smooth=!argv[1].includes("s"));var _=g(),d=context.getSession(),I=context.remember(),y=d.getRegionSelector(player.getWorld()),M=y.getRegion(),N=context.getBlock("air"),C=context.getBlock("water"),k=context.getBlock("lava"),m=Vector.UNIT_Y,V=Vector.UNIT_Y.multiply(-1);function w(t){return t.lon}function x(t){return t.lat}function S(t){for(var e=t;!E.includes(I.getBlock(e.add(m)).id);)e=e.add(m);for(;E.includes(I.getBlock(e).id);)e=e.add(V);return e.y}function B(t,e){var r=new Vector(e.x,t,e.z),n=I.getBlock(r);if(r.y<e.y){for(var i=I.getBlock(r.add(V)),s=r.y;s<e.y;s++)I.setBlock(r,i),r=r.add(m);I.setBlock(e,n)}else if(r.y>e.y){for(var a=I.getBlock(e)===C?C:N,o=r.y+1;o>e.y;o--)I.setBlock(r,a),r=r.add(V);I.setBlock(e,n)}return t}p.water||(E.indexOf(C.id)<0&&E.push(C.id),E.indexOf(k.id)<0&&E.push(k.id)),function(){var t=function(){player.print("\xa77Please wait...");for(var t=M.iterator(),e={};t.hasNext();){var r=t.next(),n=r.x,i=r.z;e[n]||(e[n]={}),e[n][i]=!0}var s,a,o=(s=new f,a=(new h).orientProjection(s),new u(a,7318261.522857145,7318261.522857145)),c=[];for(var l in e)for(var T in e[l]){var R=Number.parseFloat(l),O=Number.parseFloat(T),v=o.toGeo(R,O);c.push({x:R,z:O,lon:v[0].toFixed(5),lat:v[1].toFixed(5)})}return c}(),e=_.ignBlockLimit;if(e&&e>0&&t.length>e)player.printError("Please select an area of less than ".concat(e," blocks"));else{var r,n,i,s,a,o,c,l,T=(r=t,n=[],i=function(){player.print("".concat(n.length," blocks have failed to elevate. Retrying..."));var t=n;n=[],i=function(){player.printError("".concat(n.length," blocks failed to elevate.\nPlease select a slightly different region."))},l(t,50)},s=[],a=0,o=Number.MIN_VALUE,c=Number.MAX_VALUE,(l=function(t,e){for(var r=[],h=function(i){var a,h,l,u,T=t.slice(i,i+e).filter(function(t){return t}),R=T.map(w).join("|"),f=T.map(x).join("|"),O="http://wxs.ign.fr/".concat("3r53l5iudkvvitord0zrh8in","/alti/rest/elevation.json?lon=").concat(R,"&lat=").concat(f,"&zonly=true");r.push((a=O,h=function(t){for(var e=t.elevations,r=0;r<T.length;r++)if(e[r]>-99999){T[r].y=0|e[r];var i=S(new Vector(T[r].x,T[r].y,T[r].z));T[r].previousY=i,s.push(T[r]),o=Math.max(o,e[r],i),c=Math.min(c,e[r],i)}else n.push(T[r])},l=function(t){t.match("Request Error:\nEmpty JSON string")?player.print("\xa77Too many requests, please reduce region size next time."):player.printError(t),n=n.concat(T)},(u=new Thread(function(){var t=null;try{var e=new URL(a).openConnection();e.addRequestProperty("User-Agent","BTE-tools");var r=new StringWriter;IOUtils.copy(e.getInputStream(),r,StandardCharsets.UTF_8),t=JSON.parse(r.toString())}catch(n){return void l(("Request Error:\n"+(n.message||a)).split("http")[0])}try{h(t)}catch(n){l(("Callback Error:\n"+(n.message||a)).split("http")[0])}})).start(),u))},l=0;l<t.length;l+=e)h(l);player.print("Requesting information (".concat(t.length," blocs divided into ").concat(r.length," requests)..."));for(var u=0;u<r.length;u++)for(r[u].join();s.length>0;){var T=s.shift();if(T){var R=new Vector(T.x,T.y,T.z);B(T.previousY,R),a++}}n.length>0&&i()})(r,150),player.print("Elevated ".concat(a,"/").concat(r.length," blocs successfully.")),{maxY:o,minY:c});p.smooth&&function(t){var e=T.maxY,r=T.minY;I.flushQueue();var n=Math.max(e-M.getMaximumPoint().y,0),i=Math.min(r-M.getMinimumPoint().y,0);M.expand(new Vector(0,n,0),new Vector(0,i,0));try{M.expand(new Vector(2,0,2),new Vector(-2,0,-2))}catch(s){}new RegionCommands(WorldEdit.getInstance()).smooth(context.getPlayer(),context.remember(),M,2,!1);try{M.contract(new Vector(2,0,2),new Vector(-2,0,-2))}catch(a){}y.learnChanges(),y.explainRegionAdjust(player,d)}()}}()}();