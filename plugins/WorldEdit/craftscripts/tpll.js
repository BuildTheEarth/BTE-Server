!function(){"use strict";function t(r,e,i){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,r,e){var i=function(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=n(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(e):a.value}})(r,e,i||r)}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");var e,i;t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&(e=t,i=r,(Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(e,i))}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,a,s,h=n(t);if(e){var o=n(this).constructor;i=Reflect.construct(h,arguments,o)}else i=h.apply(this,arguments);return a=this,!(s=i)||"object"!==r(s)&&"function"!=typeof s?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(a):s}}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function s(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,r,e){return r&&s(t.prototype,r),e&&s(t,e),t}importPackage(Packages.java.io),importPackage(Packages.java.awt);var o=function(){function t(){a(this,t),this.Orientation={none:1,upright:2,swapped:3}}return h(t,[{key:"orientProjection",value:function(t){return t.upright()?t:new T(t)}},{key:"upright",value:function(){return this.fromGeo(0,90)[1]<=this.fromGeo(0,-90)[1]}}]),t}(),u=function(t){e(n,o);var r=i(n);function n(t){var e;return a(this,n),(e=r.call(this)).input=t,e}return h(n,[{key:"upright",value:function(){return this.input.upright()}},{key:"bounds",value:function(){return this.input.bounds()}},{key:"metersPerUnit",value:function(){return this.input.metersPerUnit()}}]),n}(),T=function(t){e(n,u);var r=i(n);function n(){return a(this,n),r.apply(this,arguments)}return h(n,[{key:"toGeo",value:function(t,r){return this.input.toGeo(t,-r)}},{key:"fromGeo",value:function(t,r){var e=this.input.fromGeo(t,r);return e[1]=-e[1],e}},{key:"upright",value:function(){return!this.input.upright()}},{key:"bounds",value:function(){var t=this.input.bounds();return new[t[0],-t[3],t[2],-t[1]]}}]),n}(),c=function(t){e(n,u);var r=i(n);function n(t,e,i){var s;return a(this,n),(s=r.call(this,t)).scaleX=e,s.scaleY=i||e,s}return h(n,[{key:"toGeo",value:function(t,r){return this.input.toGeo(t/this.scaleX,r/this.scaleY)}},{key:"fromGeo",value:function(t,r){var e=this.input.fromGeo(t,r);return e[0]*=this.scaleX,e[1]*=this.scaleY,e}},{key:"upright",value:function(){return!!(this.scaleY<0^this.input.upright())}},{key:"bounds",value:function(){var t=this.input.bounds();return t[0]*=this.scaleX,t[1]*=this.scaleY,t[2]*=this.scaleX,t[3]*=this.scaleY,t}},{key:"metersPerUnit",value:function(){return this.input.metersPerUnit()/Math.sqrt((this.scaleX*this.scaleX+this.scaleY*this.scaleY)/2)}}]),n}(),R=function(t){e(n,o);var r=i(n);function n(){var t;a(this,n),(t=r.call(this)).ARC=2*Math.asin(Math.sqrt(5-Math.sqrt(5))/Math.sqrt(10)),t.TO_RADIANS=Math.PI/180,t.ROOT3=Math.sqrt(3),t.newton=5,t.VERT=[10.536199,64.7,-5.24539,2.300882,58.157706,10.447378,122.3,39.1,-143.47849,50.103201,-67.13233,23.717925,36.52151,-50.1032,112.867673,-23.71793,174.75461,-2.300882,-121.84229,-10.44735,-57.7,-39.1,-169.4638,-64.7],t.ISO=[2,1,6,1,0,2,0,1,5,1,5,10,1,6,10,7,2,6,2,3,7,3,0,2,0,3,4,4,0,5,5,4,9,9,5,10,10,9,11,11,6,10,6,7,11,8,3,7,8,3,4,8,4,9,9,8,11,7,8,11,11,6,7,3,7,8],t.CENTER_MAP=[-3,7,-2,5,-1,7,2,5,4,5,-4,1,-3,-1,-2,1,-1,-1,0,1,1,-1,2,1,3,-1,4,1,5,-1,-3,-5,-1,-5,1,-5,2,-7,-4,-7,-5,-5,-2,-7],t.FLIP_TRIANGLE=[1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,1,1,0,0,1,0],t.CENTROID=new Array(66),t.ROTATION_MATRIX=new Array(198),t.INVERSE_ROTATION_MATRIX=new Array(198);for(var e=0;e<22;e++)t.CENTER_MAP[2*e]*=.5*t.ARC,t.CENTER_MAP[2*e+1]*=t.ARC*t.ROOT3/12;for(var i=0;i<12;i++)t.VERT[2*i+1]=90-t.VERT[2*i+1],t.VERT[2*i]*=t.TO_RADIANS,t.VERT[2*i+1]*=t.TO_RADIANS;for(var s=0;s<22;s++){var h=t.cart(t.VERT[2*t.ISO[3*s]],t.VERT[2*t.ISO[3*s]+1]),o=t.cart(t.VERT[2*t.ISO[3*s+1]],t.VERT[2*t.ISO[3*s+1]+1]),u=t.cart(t.VERT[2*t.ISO[3*s+2]],t.VERT[2*t.ISO[3*s+2]+1]),T=h[0]+o[0]+u[0],c=h[1]+o[1]+u[1],R=h[2]+o[2]+u[2],l=Math.sqrt(T*T+c*c+R*R);t.CENTROID[3*s]=T/l,t.CENTROID[3*s+1]=c/l,t.CENTROID[3*s+2]=R/l;var O=Math.atan2(c,T),f=Math.atan2(Math.sqrt(T*T+c*c),R),A=[t.VERT[2*t.ISO[3*s]],t.VERT[2*t.ISO[3*s]+1]];A=t.yRot(A[0]-O,A[1],-f),t.produceZYZRotationMatrix(t.ROTATION_MATRIX,9*s,-O,-f,Math.PI/2-A[0]),t.produceZYZRotationMatrix(t.INVERSE_ROTATION_MATRIX,9*s,A[0]-Math.PI/2,f,O)}return t.FACE_ON_GRID=[-1,-1,0,1,2,-1,-1,3,-1,4,-1,-1,5,6,7,8,9,10,11,12,13,14,20,19,15,21,16,-1,17,18,-1,-1,-1],t.Z=Math.sqrt(5+2*Math.sqrt(5))/Math.sqrt(15),t.EL=Math.sqrt(8)/Math.sqrt(5+Math.sqrt(5)),t.EL6=t.EL/6,t.DVE=Math.sqrt(3+Math.sqrt(5))/Math.sqrt(5+Math.sqrt(5)),t.R=-3*t.EL6/t.DVE,t.OUT_OF_BOUNDS=[NaN,NaN],t}return h(n,[{key:"produceZYZRotationMatrix",value:function(t,r,e,i,n){var a=Math.sin(e),s=Math.cos(e),h=Math.sin(i),o=Math.cos(i),u=Math.sin(n),T=Math.cos(n);t[r+0]=s*o*T-u*a,t[r+1]=-a*o*T-u*s,t[r+2]=T*h,t[r+3]=u*o*s+T*a,t[r+4]=T*s-u*o*a,t[r+5]=u*h,t[r+6]=-h*s,t[r+7]=h*a,t[r+8]=o}},{key:"cart",value:function(t,r){var e=Math.sin(r);return[e*Math.cos(t),e*Math.sin(t),Math.cos(r)]}},{key:"findTriangle",value:function(t,r,e){for(var i=Number.MAX_VALUE,n=0,a=0;a<20;a++){var s=this.CENTROID[3*a]-t,h=this.CENTROID[3*a+1]-r,o=this.CENTROID[3*a+2]-e,u=s*s+h*h+o*o;if(u<i){if(u<.1)return a;n=a,i=u}}return n}},{key:"findMapTriangle",value:function(t,r){for(var e=Number.MAX_VALUE,i=0,n=0;n<20;n++){var a=this.CENTER_MAP[2*n]-t,s=this.CENTER_MAP[2*n+1]-r,h=a*a+s*s;h<e&&(i=n,e=h)}return i}},{key:"findTriangleGrid",value:function(t,r){var e,i=t/this.ARC,n=r/(this.ARC*this.ROOT3);if(n>-.25)if(n<.25)e=1;else{if(!(n<=.75))return-1;e=0,n=.5-n}else{if(!(n>=-.75))return-1;e=2,n=-n-.5}var a=i-(n+=.25),s=i+n,h=Math.floor(a),o=2*h+(Math.floor(s)!==h?1:0)+6;return o<0||o>=11?-1:this.FACE_ON_GRID[11*e+o]}},{key:"triangleTransform",value:function(t,r,e){var i=this.Z/e,n=i*t,a=i*r,s=Math.atan((2*a/this.ROOT3-this.EL6)/this.DVE),h=Math.atan((n-a/this.ROOT3-this.EL6)/this.DVE),o=Math.atan((-n-a/this.ROOT3-this.EL6)/this.DVE);return[.5*(h-o),(2*s-h-o)/(2*this.ROOT3)]}},{key:"inverseTriangleTransformNewton",value:function(t,r){for(var e=Math.tan(this.ROOT3*r+t),i=Math.tan(2*t),n=e*e+1,a=i*i+1,s=e,h=i,o=0,u=1,T=1,c=0;c<this.newton;c++)s=((o-=(s+h+o-this.R)/(n*u*u+a*T*T+1))+e)*(u=1/(1-o*e)),h=(o+i)*(T=1/(1-o*i));var R=this.ROOT3*(this.DVE*s+this.EL6)/2,l=(this.DVE*h+R/this.ROOT3+this.EL6)/this.Z,O=R/this.Z,f=1/Math.sqrt(1+l*l+O*O);return[f*l,f*O,f]}},{key:"inverseTriangleTransformCbrt",value:function(t,r){var e=Math.tan(this.ROOT3*r+t),i=Math.tan(2*t),n=i*e,a=-(this.R*i*e+2*i+2*e),s=3+this.R*i+this.R*e-2*i*e,h=-a/(3*n),o=h*h*h+(a*s-3*n*(i+e-this.R))/(6*n*n),u=s/(3*n)-h*h,T=Math.sqrt(-(o*o+u*u*u)),c=Math.sqrt(T*T+o*o),R=Math.atan2(T,o),l=2*Math.cbrt(c)*Math.cos(R/3)+h,O=(l+e)/(1-l*e),f=(l+i)/(1-l*i),A=this.ROOT3*(this.DVE*O+this.EL6)/2,E=(this.DVE*f+A/this.ROOT3+this.EL6)/this.Z,v=A/this.Z,_=1/Math.sqrt(1+E*E+v*v);return[_*E,_*v,_]}},{key:"inverseTriangleTransformCbrtNewton",value:function(t,r){for(var e=Math.tan(this.ROOT3*r+t),i=Math.tan(2*t),n=e+i,a=i*e,s=-(this.R*a+2*i+2*e),h=3+this.R*n-2*a,o=n-this.R,u=3*a,T=2*s,c=-o/h,R=0;R<this.newton;R++){var l=c*c;c-=(a*l*c+s*l+h*c+o)/(u*l+T*c+h)}var O=(c+e)/(1-c*e),f=(c+i)/(1-c*i),A=this.ROOT3*(this.DVE*O+this.EL6)/2,E=(this.DVE*f+A/this.ROOT3+this.EL6)/this.Z,v=A/this.Z,_=1/Math.sqrt(1+E*E+v*v);return[_*E,_*v,_]}},{key:"inverseTriangleTransform",value:function(t,r){return this.inverseTriangleTransformNewton(t,r)}},{key:"yRot",value:function(t,r,e){var i=this.cart(t,r),n=i[0];i[0]=i[2]*Math.sin(e)+n*Math.cos(e),i[2]=i[2]*Math.cos(e)-n*Math.sin(e);var a=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);return i[0]/=a,i[1]/=a,i[2]/=a,[Math.atan2(i[1],i[0]),Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),i[2])]}},{key:"fromGeo",value:function(t,r){r=90-r,t*=this.TO_RADIANS,r*=this.TO_RADIANS;var e=Math.sin(r),i=Math.cos(t)*e,n=Math.sin(t)*e,a=Math.cos(r),s=this.findTriangle(i,n,a),h=9*s,o=i*this.ROTATION_MATRIX[h+0]+n*this.ROTATION_MATRIX[h+1]+a*this.ROTATION_MATRIX[h+2],u=i*this.ROTATION_MATRIX[h+3]+n*this.ROTATION_MATRIX[h+4]+a*this.ROTATION_MATRIX[h+5],T=i*this.ROTATION_MATRIX[h+6]+n*this.ROTATION_MATRIX[h+7]+a*this.ROTATION_MATRIX[h+8],c=this.triangleTransform(o,u,T);return 0!==this.FLIP_TRIANGLE[s]&&(c[0]=-c[0],c[1]=-c[1]),i=c[0],(15===s&&i>c[1]*this.ROOT3||14===s)&&i>0&&(c[0]=.5*i-.5*this.ROOT3*c[1],c[1]=.5*this.ROOT3*i+.5*c[1],s+=6),c[0]+=this.CENTER_MAP[2*s],c[1]+=this.CENTER_MAP[2*s+1],c}},{key:"toGeo",value:function(t,r){var e=this.findTriangleGrid(t,r);if(-1===e)return this.OUT_OF_BOUNDS;switch(t-=this.CENTER_MAP[2*e],r-=this.CENTER_MAP[2*e+1],e){case 14:if(t>0)return this.OUT_OF_BOUNDS;break;case 20:if(-r*this.ROOT3>t)return this.OUT_OF_BOUNDS;break;case 15:if(t>0&&t>r*this.ROOT3)return this.OUT_OF_BOUNDS;break;case 21:if(t<0||-r*this.ROOT3>t)return this.OUT_OF_BOUNDS}0!==this.FLIP_TRIANGLE[e]&&(t=-t,r=-r);var i=this.inverseTriangleTransform(t,r);t=i[0],r=i[1];var n=i[2],a=9*e,s=t*this.INVERSE_ROTATION_MATRIX[a+0]+r*this.INVERSE_ROTATION_MATRIX[a+1]+n*this.INVERSE_ROTATION_MATRIX[a+2],h=t*this.INVERSE_ROTATION_MATRIX[a+3]+r*this.INVERSE_ROTATION_MATRIX[a+4]+n*this.INVERSE_ROTATION_MATRIX[a+5],o=t*this.INVERSE_ROTATION_MATRIX[a+6]+r*this.INVERSE_ROTATION_MATRIX[a+7]+n*this.INVERSE_ROTATION_MATRIX[a+8];return[Math.atan2(h,s)/this.TO_RADIANS,90-Math.acos(o)/this.TO_RADIANS]}},{key:"bounds",value:function(){return[-3*this.ARC,-.75*this.ARC*this.ROOT3,2.5*this.ARC,.75*this.ARC*this.ROOT3]}},{key:"upright",value:function(){return!1}},{key:"metersPerUnit",value:function(){return Math.sqrt(5101e11/(20*this.ROOT3*this.ARC*this.ARC/4))}}]),n}(),l=function(r){e(o,R);var s=i(o);function o(){var t;a(this,o),(t=s.call(this)).VECTOR_SCALE_FACTOR=.8715371854532509;for(var r=null,e=new Array(257),i=new Array(e.length),n=0;n<e.length;n++)e[n]=[];for(var h=0;h<i.length;h++)i[h]=[];try{if((r=context.getSafeOpenFile("craftscripts/data","conformal","txt")).exists()){for(var u=new BufferedReader(new FileReader(r)),T=0;T<e.length;T++){var c=new Array(e.length-T),R=new Array(e.length-T);e[T]=c,i[T]=R}for(var l=0;l<e.length;l++)for(var O=0;O<e.length-l;O++){var A=u.readLine(),E=(A=A.substring(1,A.length()-3)).split(", ");e[O][l]=Number.parseFloat(E[0])*t.VECTOR_SCALE_FACTOR,i[O][l]=Number.parseFloat(E[1])*t.VECTOR_SCALE_FACTOR}}else player.printError("Conformal.txt doesn't exist.");u.close()}catch(v){player.printError("Can't load conformal: "+v)}return t.inverse=new f(e,i),t}return h(o,[{key:"triangleTransform",value:function(r,e,i){var a=t(n(o.prototype),"triangleTransform",this).call(this,r,e,i);return r=a[0],e=a[1],a[0]/=this.ARC,a[1]/=this.ARC,a[0]+=.5,a[1]+=this.ROOT3/6,(a=this.inverse.applyNewtonsMethod(r,e,a[0],a[1],5))[0]-=.5,a[1]-=this.ROOT3/6,a[0]*=this.ARC,a[1]*=this.ARC,a}},{key:"inverseTriangleTransform",value:function(r,e){r/=this.ARC,e/=this.ARC,r+=.5,e+=this.ROOT3/6;var i=this.inverse.getInterpolatedVector(r,e);return t(n(o.prototype),"inverseTriangleTransform",this).call(this,i[0],i[1])}},{key:"metersPerUnit",value:function(){return 40075017/(2*Math.PI)/this.VECTOR_SCALE_FACTOR}}]),o}(),O=function(r){e(o,l);var s=i(o);function o(){var t;return a(this,o),(t=s.call(this)).THETA=-150*t.TO_RADIANS,t.SIN_THETA=Math.sin(t.THETA),t.COS_THETA=Math.cos(t.THETA),t.BERING_X=-.3420420960118339,t.BERING_Y=-.322211064085279,t.ARCTIC_Y=-.2,t.ARCTIC_M=(t.ARCTIC_Y-t.ROOT3*t.ARC/4)/(t.BERING_X- -.5*t.ARC),t.ARCTIC_B=t.ARCTIC_Y-t.ARCTIC_M*t.BERING_X,t.ALEUTIAN_Y=-.5000446805492526,t.ALEUTIAN_XL=-.5149231279757507,t.ALEUTIAN_XR=-.45,t.ALEUTIAN_M=(t.BERING_Y-t.ALEUTIAN_Y)/(t.BERING_X-t.ALEUTIAN_XR),t.ALEUTIAN_B=t.BERING_Y-t.ALEUTIAN_M*t.BERING_X,t}return h(o,[{key:"fromGeo",value:function(r,e){var i=t(n(o.prototype),"fromGeo",this).call(this,r,e),a=i[0],s=i[1],h=this.isEurasianPart(a,s);if(s-=.75*this.ARC*this.ROOT3,h){var u=a+=this.ARC;a=this.COS_THETA*a-this.SIN_THETA*s,s=this.SIN_THETA*u+this.COS_THETA*s}else a-=this.ARC;return i[0]=s,i[1]=-a,i}},{key:"toGeo",value:function(r,e){var i;i=e<0?r>0:e>this.ARC/2?r>-this.ROOT3*this.ARC/2:e*-this.ROOT3<r;var a=r;return r=-e,e=a,i?(a=r,r=this.COS_THETA*r+this.SIN_THETA*e,e=this.COS_THETA*e-this.SIN_THETA*a,r-=this.ARC):r+=this.ARC,e+=.75*this.ARC*this.ROOT3,i!==this.isEurasianPart(r,e)?this.OUT_OF_BOUNDS:t(n(o.prototype),"toGeo",this).call(this,r,e)}},{key:"isEurasianPart",value:function(t,r){return!(t>0)&&(t<-.5*this.ARC||(r>this.ROOT3*this.ARC/4?t<0:r<this.ALEUTIAN_Y?r<this.ALEUTIAN_Y+this.ALEUTIAN_XL-t:r>this.BERING_Y?r<this.ARCTIC_Y?t<this.BERING_X:r<this.ARCTIC_M*t+this.ARCTIC_B:r>this.ALEUTIAN_M*t+this.ALEUTIAN_B))}},{key:"bounds",value:function(){return[-1.5*this.ARC*this.ROOT3,-1.5*this.ARC,3*this.ARC,this.ROOT3*this.ARC]}}]),o}(),f=function(){function t(r,e){a(this,t),this.ROOT3=Math.sqrt(3),this.sideLength=r.length-1,this.VECTOR_X=r,this.VECTOR_Y=e}return h(t,[{key:"getInterpolatedVector",value:function(t,r){t*=this.sideLength;var e,i,n,a,s,h,o,u,T=2*(r*=this.sideLength)/this.ROOT3,c=t-.5*T,R=Math.trunc(c),l=Math.trunc(T);R<0?R=0:R>=this.sideLength&&(R=this.sideLength-1),l<0?l=0:l>=this.sideLength-R&&(l=this.sideLength-R-1);var O=1;r<-this.ROOT3*(t-R-l-1)||l===this.sideLength-R-1?(e=this.VECTOR_X[R][l],i=this.VECTOR_Y[R][l],n=this.VECTOR_X[R][l+1],a=this.VECTOR_Y[R][l+1],s=this.VECTOR_X[R+1][l],h=this.VECTOR_Y[R+1][l],o=.5*this.ROOT3*l,u=R+1+.5*l):(e=this.VECTOR_X[R][l+1],i=this.VECTOR_Y[R][l+1],n=this.VECTOR_X[R+1][l],a=this.VECTOR_Y[R+1][l],s=this.VECTOR_X[R+1][l+1],h=this.VECTOR_Y[R+1][l+1],O=-1,r=-r,o=-.5*this.ROOT3*(l+1),u=R+1+.5*(l+1));var f=-(r-o)/this.ROOT3-(t-u),A=2*(r-o)/this.ROOT3,E=1-f-A;return[e*f+n*A+s*E,i*f+a*A+h*E,(s-e)*this.sideLength,this.sideLength*O*(2*n-e-s)/this.ROOT3,(h-i)*this.sideLength,this.sideLength*O*(2*a-i-h)/this.ROOT3]}},{key:"applyNewtonsMethod",value:function(t,r,e,i,n){for(var a=0;a<n;a++){var s=this.getInterpolatedVector(e,i),h=s[0]-t,o=s[1]-r,u=s[2],T=s[3],c=s[4],R=s[5],l=1/(u*R-T*c);e-=l*(R*h-T*o),i-=l*(-c*h+u*o)}return[e,i]}}]),t}();function A(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],i=!0,n=!1,a=void 0;try{for(var s,h=t[Symbol.iterator]();!(i=(s=h.next()).done)&&(e.push(s.value),!r||e.length!==r);i=!0);}catch(o){n=!0,a=o}finally{try{i||null==h.return||h.return()}finally{if(n)throw a}}return e}}(t,r)||function(t,r){if(t){if("string"==typeof t)return E(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?E(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,i=new Array(r);e<r;e++)i[e]=t[e];return i}importPackage(Packages.com.sk89q.worldedit),importPackage(Packages.com.sk89q.worldedit.math);var v="<latitude> <longitude> [altitude]\n \u2022 \xa7o/cs tpll 47.58523 6.89725\n \u2022 \xa7o/cs tpll 47.58523, 6.89725 370\n \u2022 \xa7o/cs tpll 47\xb035'6.32\"N 6\xb053'50.06\"E\n \u2022 \xa7o/cs tpll 47\xb035'6.32\"N, 6\xb053'50.06\"E 370";context.checkArgs(2,3,v),player.print("\xa77\xa7oTeleportation...");var _,p,I=(_=new O,p=(new o).orientProjection(_),new c(p,7318261.522857145,7318261.522857145));function y(){var t,r=A(I.fromGeo(Number.parseFloat(argv[2]),Number.parseFloat(argv[1])),2),e=r[0],i=r[1];if(argv[3])t=new Vector(e,Number.parseFloat(argv[3])-2,i);else{t=new Vector(e,player.getPosition().y,i);for(var n=context.remember();n.getBlock(t.add(new Vector(0,1,0))).id!==context.getBlock("air").id;)t=t.add(new Vector(0,1,0));for(;n.getBlock(t).id===context.getBlock("air").id;)t=t.add(new Vector(0,-1,0))}player.setPosition(t.add(new Vector(0,2,0))),player.print("Teleported to ".concat(t.x," ").concat(t.y," ").concat(t.z))}function M(t){var r=A((t=""+t).split(new RegExp("\xb0|\\'|\\\"")),3),e=r[0],i=r[1],n=r[2];return Number.parseFloat(e)+Number.parseFloat(i)/60+Number.parseFloat(n)/3600}argv[1].replace(",",""),argv[2].replace(",",""),(argv[1]+"").match(new RegExp("\\d*\xb0\\d*'\\d*.\\d*\""))&&(argv[2]+"").match(new RegExp("\\d*\xb0\\d*'\\d*.\\d*\""))?(argv[1]=M(argv[1]),argv[2]=M(argv[2]),y()):(argv[1]+"").match(new RegExp("\\d*"))&&(argv[2]+"").match(new RegExp("\\d*"))?y():(player.printError("Wrong usage"),player.printError(v))}();